<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nivel 1 - El Amor en Código</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <canvas id="game" width="800" height="400"></canvas>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    let player = { x: 50, y: 300, w: 40, h: 40, vy: 0, grounded: false };
    const gravity = 0.8;
    const keys = {};
    let heart = { x: 700, y: 300, w: 30, h: 30, found: false };

    const platforms = [
      { x: 0, y: 350, w: 800, h: 50 },
      { x: 300, y: 280, w: 100, h: 10 },
      { x: 500, y: 220, w: 100, h: 10 }
    ];

    function update() {
      if (keys['ArrowRight']) player.x += 4;
      if (keys['ArrowLeft']) player.x -= 4;
      if ((keys[' '] || keys['ArrowUp']) && player.grounded) player.vy = -15;

      player.vy += gravity;
      player.y += player.vy;
      player.grounded = false;

      // Colisiones con plataformas
      platforms.forEach(p => {
        if (
          player.x < p.x + p.w &&
          player.x + player.w > p.x &&
          player.y + player.h > p.y &&
          player.y + player.h < p.y + p.h &&
          player.vy >= 0
        ) {
          player.y = p.y - player.h;
          player.vy = 0;
          player.grounded = true;
        }
      });

      // Colisión con el corazón
      if (
        player.x < heart.x + heart.w &&
        player.x + player.w > heart.x &&
        player.y < heart.y + heart.h &&
        player.y + player.h > heart.y
      ) {
        heart.found = true;
        setTimeout(() => {
          window.location.href = "love.html";
        }, 800);
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Fondo
      const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
      gradient.addColorStop(0, "#444");
      gradient.addColorStop(1, "#222");
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Jugador
      ctx.fillStyle = "#fff";
      ctx.fillRect(player.x, player.y, player.w, player.h);

      // Plataformas
      ctx.fillStyle = "#4caf50";
      platforms.forEach(p => ctx.fillRect(p.x, p.y, p.w, p.h));

      // Corazón
      if (!heart.found) {
        ctx.fillStyle = "red";
        ctx.beginPath();
        ctx.arc(heart.x + heart.w / 2, heart.y + heart.h / 2, 10, 0, Math.PI * 2);
        ctx.fill();
      }

      // Texto
      ctx.font = "20px Arial";
      ctx.fillStyle = "#ffc0cb";
      ctx.fillText("Nivel 1 - ¡Encuentra el corazón! ❤", 20, 30);
    }

    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    document.addEventListener('keydown', e => keys[e.key] = true);
    document.addEventListener('keyup', e => keys[e.key] = false);

    loop();
  </script>
</body>
</html>
